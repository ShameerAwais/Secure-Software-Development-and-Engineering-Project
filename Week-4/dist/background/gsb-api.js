const _0x14b27d=_0x19ac;(function(_0x2f1f8c,_0xa21ac4){const _0x359adb=_0x19ac,_0x9ac359=_0x2f1f8c();while(!![]){try{const _0x4d7597=parseInt(_0x359adb(0x243))/0x1+parseInt(_0x359adb(0x217))/0x2+parseInt(_0x359adb(0x1ec))/0x3+parseInt(_0x359adb(0x202))/0x4*(parseInt(_0x359adb(0x1f2))/0x5)+parseInt(_0x359adb(0x23c))/0x6*(-parseInt(_0x359adb(0x1db))/0x7)+parseInt(_0x359adb(0x1dd))/0x8+-parseInt(_0x359adb(0x245))/0x9;if(_0x4d7597===_0xa21ac4)break;else _0x9ac359['push'](_0x9ac359['shift']());}catch(_0x5485a9){_0x9ac359['push'](_0x9ac359['shift']());}}}(_0x3d9b,0xbff39));const _0x5f34f1=(function(){const _0x531a44=_0x19ac,_0x4ad2b8={};_0x4ad2b8[_0x531a44(0x216)]='MrYSv';const _0x3a108b=_0x4ad2b8;let _0x2247ca=!![];return function(_0xb0d524,_0x2505ad){const _0x1575cf=_0x531a44,_0x36e39b={};_0x36e39b[_0x1575cf(0x20b)]=function(_0x2b57e7,_0x312f78){return _0x2b57e7!==_0x312f78;},_0x36e39b[_0x1575cf(0x204)]=_0x3a108b[_0x1575cf(0x216)];const _0x1fd74e=_0x36e39b,_0x2086d8=_0x2247ca?function(){const _0x1b3aff=_0x1575cf;if(_0x1fd74e[_0x1b3aff(0x20b)](_0x1fd74e[_0x1b3aff(0x204)],_0x1b3aff(0x1df))){const _0xc2be69=_0x49c010?function(){const _0x5714f5=_0x1b3aff;if(_0x5656f0){const _0x31d95=_0x5dd74a[_0x5714f5(0x20e)](_0x111172,arguments);return _0x172aac=null,_0x31d95;}}:function(){};return _0x28616b=![],_0xc2be69;}else{if(_0x2505ad){const _0x3efecf=_0x2505ad[_0x1b3aff(0x20e)](_0xb0d524,arguments);return _0x2505ad=null,_0x3efecf;}}}:function(){};return _0x2247ca=![],_0x2086d8;};}()),_0x3f6f6a=_0x5f34f1(this,function(){const _0x44023e=_0x19ac,_0x26b0c2={};_0x26b0c2[_0x44023e(0x218)]='(((.+)+)+)'+'+$';const _0x516fea=_0x26b0c2;return _0x3f6f6a[_0x44023e(0x1e5)]()[_0x44023e(0x231)](_0x516fea[_0x44023e(0x218)])[_0x44023e(0x1e5)]()['constructo'+'r'](_0x3f6f6a)[_0x44023e(0x231)](_0x44023e(0x1f4)+'+$');});_0x3f6f6a();const _0x5a99db=(function(){const _0x472470=_0x19ac,_0x2c1baf={};_0x2c1baf[_0x472470(0x201)]=function(_0x58d8c5,_0x6aa214){return _0x58d8c5===_0x6aa214;},_0x2c1baf['dCLmC']=_0x472470(0x1e1);const _0x18482e=_0x2c1baf;let _0x12e2ea=!![];return function(_0x1f5538,_0x149dcc){const _0x1399e9=_0x472470;if(_0x18482e[_0x1399e9(0x201)](_0x18482e['dCLmC'],'OELto')){const _0x42dc87=_0x12e2ea?function(){if(_0x149dcc){const _0x2f2a2b=_0x149dcc['apply'](_0x1f5538,arguments);return _0x149dcc=null,_0x2f2a2b;}}:function(){};return _0x12e2ea=![],_0x42dc87;}else{const _0x484453={};_0x484453[_0x1399e9(0x21e)]=_0x9b9cde[_0x1399e9(0x21e)],_0x484453[_0x1399e9(0x207)+'ion']=_0x4f7e48[_0x1399e9(0x207)+_0x1399e9(0x23f)];const _0x52363d={};_0x52363d['url']=_0x387728;const _0x4b73ca={};_0x4b73ca[_0x1399e9(0x225)+'s']=_0xbe989,_0x4b73ca[_0x1399e9(0x205)+_0x1399e9(0x244)]=_0x532d42,_0x4b73ca[_0x1399e9(0x20a)+_0x1399e9(0x1f1)]=['URL'],_0x4b73ca[_0x1399e9(0x20a)+_0x1399e9(0x1ff)]=[_0x52363d];const _0x52f8ac={};return _0x52f8ac['client']=_0x484453,_0x52f8ac['threatInfo']=_0x4b73ca,_0x52f8ac;}};}()),_0x48c20d=_0x5a99db(this,function(){const _0x3b10db=_0x19ac,_0x2aa676={'GHyJT':function(_0x50c703,_0x420f05){return _0x50c703===_0x420f05;},'utJoW':_0x3b10db(0x1ee),'mzLiv':function(_0x57285e,_0x146070){return _0x57285e!==_0x146070;},'eotgo':'WQZqn','HenCe':function(_0x59811f,_0x3bede0){return _0x59811f(_0x3bede0);},'DTRzz':function(_0x5e10c8,_0x36deb8){return _0x5e10c8+_0x36deb8;},'XaKET':_0x3b10db(0x1eb)+_0x3b10db(0x240),'UUpgb':function(_0x103a93){return _0x103a93();},'grMgH':_0x3b10db(0x229),'BqckB':_0x3b10db(0x203),'KqkIR':_0x3b10db(0x234),'VTlqD':_0x3b10db(0x21a),'QKHdW':_0x3b10db(0x1e0),'HUPrj':function(_0x218027,_0x416bc5){return _0x218027<_0x416bc5;}},_0x2ecbc9=function(){const _0x93c3bf=_0x3b10db;if(_0x2aa676[_0x93c3bf(0x246)](_0x2aa676[_0x93c3bf(0x222)],_0x2aa676[_0x93c3bf(0x222)])){let _0x2d7e37;try{if(_0x2aa676[_0x93c3bf(0x219)](_0x2aa676[_0x93c3bf(0x213)],_0x2aa676[_0x93c3bf(0x213)])){const _0x107ed3=_0x408963[_0x93c3bf(0x21f)][0x0][_0x93c3bf(0x225)];_0x55685c[_0x93c3bf(0x229)](_0x26eaa8,_0x93c3bf(0x23d)+_0x93c3bf(0x228)+'t\x20type:\x20'+_0x107ed3,{'url':_0x126fb6,'threatType':_0x107ed3});const _0x1374b5={};return _0x1374b5[_0x93c3bf(0x21c)]=![],_0x1374b5[_0x93c3bf(0x225)]=_0x107ed3,_0x1374b5[_0x93c3bf(0x1e3)]=0xc8,_0x1374b5['details']=_0x125876[_0x93c3bf(0x21f)],_0x1374b5;}else _0x2d7e37=_0x2aa676[_0x93c3bf(0x1fc)](Function,_0x2aa676[_0x93c3bf(0x224)](_0x2aa676[_0x93c3bf(0x224)](_0x2aa676[_0x93c3bf(0x1ef)],_0x93c3bf(0x22d)+'ctor(\x22retu'+_0x93c3bf(0x232)+'\x20)'),');'))();}catch(_0x1de1ea){_0x2d7e37=window;}return _0x2d7e37;}else{const _0x22ec7c=_0x16a6c6[_0x93c3bf(0x20e)](_0x37254e,arguments);return _0x5d5fbf=null,_0x22ec7c;}},_0x1682d4=_0x2aa676[_0x3b10db(0x1e4)](_0x2ecbc9),_0x21b107=_0x1682d4[_0x3b10db(0x22f)]=_0x1682d4[_0x3b10db(0x22f)]||{},_0x3108f2=[_0x3b10db(0x23b),_0x2aa676[_0x3b10db(0x1ed)],_0x2aa676[_0x3b10db(0x22c)],_0x2aa676[_0x3b10db(0x214)],_0x3b10db(0x1f8),_0x2aa676[_0x3b10db(0x238)],_0x2aa676['QKHdW']];for(let _0x2e19a6=0x0;_0x2aa676[_0x3b10db(0x1f0)](_0x2e19a6,_0x3108f2[_0x3b10db(0x223)]);_0x2e19a6++){const _0x1068ec=_0x5a99db['constructo'+'r'][_0x3b10db(0x235)][_0x3b10db(0x230)](_0x5a99db),_0x155a9f=_0x3108f2[_0x2e19a6],_0xc7c9de=_0x21b107[_0x155a9f]||_0x1068ec;_0x1068ec['__proto__']=_0x5a99db[_0x3b10db(0x230)](_0x5a99db),_0x1068ec[_0x3b10db(0x1e5)]=_0xc7c9de[_0x3b10db(0x1e5)]['bind'](_0xc7c9de),_0x21b107[_0x155a9f]=_0x1068ec;}});_0x48c20d();import{SAFE_BROWSING_API_URL,THREAT_TYPES,PLATFORM_TYPES}from'../common/constants.js';import{GSB_CONFIG}from'../utils/config.js';import*as _0x4a0514 from'../utils/logger.js';import{normalizeUrl}from'../utils/url-validator.js';import*as _0x245b7e from'../utils/secure-storage.js';import{getApiKey}from'./key-installer.js';const MODULE_NAME=_0x14b27d(0x1e9);export const checkUrl=async _0x5dda95=>{const _0x10d88b=_0x14b27d,_0x394054={'ZoyjH':function(_0x5b1c07,_0x107a15){return _0x5b1c07(_0x107a15);},'diALl':'Invalid\x20UR'+'L','ZlJOo':function(_0x4bb5ac){return _0x4bb5ac();},'CRpcF':_0x10d88b(0x221),'fKqUe':_0x10d88b(0x211)+_0x10d88b(0x1f3)+'st','CoeZA':_0x10d88b(0x237)+'_REDACTED*'+'**','NMoby':'POST','tynjx':function(_0x481826,_0xdafa41,_0x194a66){return _0x481826(_0xdafa41,_0x194a66);},'AkLUn':function(_0x26efaf,_0x3e2c0e){return _0x26efaf===_0x3e2c0e;},'JQyfC':_0x10d88b(0x1e8),'LUJYx':function(_0x4f2739,_0xb888a5){return _0x4f2739>_0xb888a5;},'BGAyA':_0x10d88b(0x23a)+'e','gIcCv':'Error\x20in\x20G'+_0x10d88b(0x1e7)+_0x10d88b(0x1e6)};_0x4a0514[_0x10d88b(0x203)](MODULE_NAME,_0x10d88b(0x20f)+_0x10d88b(0x1f5)+_0x5dda95);const _0x3fdf77=_0x394054[_0x10d88b(0x20d)](normalizeUrl,_0x5dda95);if(!_0x3fdf77){_0x4a0514[_0x10d88b(0x234)](MODULE_NAME,'URL\x20is\x20inv'+_0x10d88b(0x1de)+_0x10d88b(0x227)+'\x20normalize'+'d');const _0x5c72f2={};return _0x5c72f2[_0x10d88b(0x21c)]=![],_0x5c72f2[_0x10d88b(0x225)]=null,_0x5c72f2['statusCode']=0x190,_0x5c72f2[_0x10d88b(0x234)]=_0x394054[_0x10d88b(0x1fe)],_0x5c72f2;}const _0xb932cb=_0x394054['ZoyjH'](constructRequestBody,_0x3fdf77);try{const _0x3fcc54=new URL(SAFE_BROWSING_API_URL);let _0xb5666c=await _0x394054[_0x10d88b(0x212)](getApiKey);!_0xb5666c&&(_0x4a0514['warn'](MODULE_NAME,_0x10d88b(0x200)+_0x10d88b(0x242)+_0x10d88b(0x1da)+_0x10d88b(0x21d)),_0xb5666c=GSB_CONFIG['apiKey']);_0x3fcc54[_0x10d88b(0x1f7)+'ms']['append'](_0x394054[_0x10d88b(0x1f6)],_0xb5666c),_0x4a0514[_0x10d88b(0x1ea)](MODULE_NAME,_0x394054[_0x10d88b(0x1fb)],{'url':_0x3fcc54[_0x10d88b(0x1e5)]()[_0x10d88b(0x209)](_0xb5666c,_0x394054['CoeZA']),'method':_0x394054[_0x10d88b(0x206)],'bodyLength':JSON[_0x10d88b(0x1e2)](_0xb932cb)[_0x10d88b(0x223)]});const _0x4cafb1={};_0x4cafb1['Content-Ty'+'pe']='applicatio'+_0x10d88b(0x233);const _0x7fb5f4=await _0x394054[_0x10d88b(0x220)](fetch,_0x3fcc54,{'method':_0x394054[_0x10d88b(0x206)],'headers':_0x4cafb1,'body':JSON[_0x10d88b(0x1e2)](_0xb932cb)});_0x4a0514['debug'](MODULE_NAME,_0x10d88b(0x1f9)+_0x10d88b(0x1fd)+_0x10d88b(0x208)+_0x7fb5f4[_0x10d88b(0x1dc)]);if(!_0x7fb5f4['ok']){if(_0x394054['AkLUn'](_0x394054[_0x10d88b(0x241)],_0x10d88b(0x1e8))){const _0xf8f983=await _0x7fb5f4[_0x10d88b(0x22b)]();_0x4a0514[_0x10d88b(0x234)](MODULE_NAME,_0x10d88b(0x22a)+'ror:\x20'+_0x7fb5f4[_0x10d88b(0x1dc)],_0xf8f983);const _0x175c0a={};return _0x175c0a[_0x10d88b(0x21c)]=![],_0x175c0a[_0x10d88b(0x225)]=null,_0x175c0a[_0x10d88b(0x1e3)]=_0x7fb5f4['status'],_0x175c0a['error']='API\x20error:'+'\x20'+_0x7fb5f4['status'],_0x175c0a;}else{if(_0x31d947){const _0x1fb243=_0x4e764b[_0x10d88b(0x20e)](_0x2d45b8,arguments);return _0x37b91c=null,_0x1fb243;}}}const _0xa79f43=await _0x7fb5f4[_0x10d88b(0x215)]();_0x4a0514[_0x10d88b(0x1ea)](MODULE_NAME,_0x10d88b(0x1f9)+'sponse\x20dat'+'a',_0xa79f43);if(_0xa79f43[_0x10d88b(0x21f)]&&_0x394054[_0x10d88b(0x20c)](_0xa79f43[_0x10d88b(0x21f)]['length'],0x0)){const _0x387721=_0xa79f43[_0x10d88b(0x21f)][0x0]['threatType'];_0x4a0514['warn'](MODULE_NAME,_0x10d88b(0x23d)+_0x10d88b(0x228)+_0x10d88b(0x236)+_0x387721,{'url':_0x3fdf77,'threatType':_0x387721});const _0x110df9={};return _0x110df9[_0x10d88b(0x21c)]=![],_0x110df9['threatType']=_0x387721,_0x110df9['statusCode']=0xc8,_0x110df9['details']=_0xa79f43[_0x10d88b(0x21f)],_0x110df9;}const _0x1a1f01={};_0x1a1f01['url']=_0x3fdf77,_0x4a0514[_0x10d88b(0x203)](MODULE_NAME,_0x394054[_0x10d88b(0x23e)],_0x1a1f01);const _0x4062b3={};return _0x4062b3[_0x10d88b(0x21c)]=!![],_0x4062b3[_0x10d88b(0x225)]=null,_0x4062b3[_0x10d88b(0x1e3)]=0xc8,_0x4062b3;}catch(_0x5b3b94){_0x4a0514['error'](MODULE_NAME,_0x394054[_0x10d88b(0x210)],_0x5b3b94);const _0x55f81b={};return _0x55f81b[_0x10d88b(0x21c)]=![],_0x55f81b[_0x10d88b(0x225)]=null,_0x55f81b[_0x10d88b(0x1e3)]=0x1f4,_0x55f81b[_0x10d88b(0x234)]=_0x5b3b94[_0x10d88b(0x226)],_0x55f81b;}};function _0x3d9b(){const _0x255417=['s3fRsvi','ANnVBG','AfvPzgq','odq4mZa0z0r2qxfk','DwvUDva','BxPmAxy','DgfIBgu','y2XPzw50','AxntywzL','BMzPzW','y2XPzw50swq','Bwf0y2HLCW','DhLUANG','A2v5','DxrkB1C','BgvUz3rO','rfrsENO','DgHYzwf0vhLWzq','BwvZC2fNzq','DwXKig5VDcbIzq','ywzLlIbuAhjLyq','D2fYBG','r1nciefqssbLCG','Dgv4Da','qNfJA0i','E30Uy29UC3rYDq','ChbHsKW','y29UC29Szq','yMLUza','C2vHCMnO','CM4GDgHPCYiPka','BI9QC29U','zxjYB3i','ChjVDg90ExbL','Dcb0ExbLoIa','kIOQqvbjx0Tfwq','vLrSCuq','DxjS','vvjmigLZihnHzG','Bg9N','mtq2nJCWnNryzLvgvq','vvjmigLZihvUCW','qKDbEue','Aw9U','BMn0Aw9UkcKG','sLf5zKm','yMfJAYbbueKGAW','nZuZnJqYvMHHs1Pz','CgvZ','mJaZmdi5otjtv0vky2i','r0H5sLq','zxKGzNjVBsbJBW','n1PWy2jVva','C3rHDhvZ','odeYnda3mMfmBNrXva','ywXPzcbVCIbJBW','txjzu3y','DhjHy2u','t0vmDg8','C3rYAw5NAwz5','C3rHDhvZq29Kzq','vvvWz2i','Dg9tDhjPBMC','DwvZDa','u0iGqvbjihjLCq','AhjUt20','r1nclufqsq','zgvIDwC','CMv0DxjUicHMDq','mJyYodaZnLHtBKPlza','z3jnz0G','zvfMAgO','wgflrvq','sfvqCMO','Evr5CgvZ','mtvhzMforMC','iefqssbYzxf1zq','kcGOlISPkYKRkq','uKW6ia','q1jWy0y','C2vHCMnOugfYyq','zxHJzxb0Aw9U','r1nciefqssbYzq','vvjm','zKTXvwu','sgvUq2u','C3bVBNnLihn0yq','zgLbtgW','AwvZ','vxnPBMCGzMfSBa','qxf0zKe','mJG5nJC2rwngqKLo','Aw5MBW','uvror1i','CgXHDgzVCM1uEq','tK1VyNK','y2XPzw50vMvYCW','DhvZoIa','CMvWBgfJzq','DgHYzwf0rw50CG','qwjiCe0','tfvkwxG','wM95AKG','yxbWBhK','q2HLy2TPBMCGvq','z0LJq3y','twfRAw5NieDtqG','wMXkt28','zw90z28'];_0x3d9b=function(){return _0x255417;};return _0x3d9b();}function _0x19ac(_0x4f6bd6,_0x4537ad){const _0x495e8e=_0x3d9b();return _0x19ac=function(_0x48c20d,_0x5a99db){_0x48c20d=_0x48c20d-0x1da;let _0x4c138b=_0x495e8e[_0x48c20d];if(_0x19ac['DUomcY']===undefined){var _0x28b94b=function(_0x19ac06){const _0x9f53d0='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x387cf6='',_0x157b27='',_0x487f76=_0x387cf6+_0x28b94b;for(let _0x1123fa=0x0,_0x5aea4e,_0x21e0fb,_0x5ddae8=0x0;_0x21e0fb=_0x19ac06['charAt'](_0x5ddae8++);~_0x21e0fb&&(_0x5aea4e=_0x1123fa%0x4?_0x5aea4e*0x40+_0x21e0fb:_0x21e0fb,_0x1123fa++%0x4)?_0x387cf6+=_0x487f76['charCodeAt'](_0x5ddae8+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x5aea4e>>(-0x2*_0x1123fa&0x6)):_0x1123fa:0x0){_0x21e0fb=_0x9f53d0['indexOf'](_0x21e0fb);}for(let _0x5195a4=0x0,_0x5627fe=_0x387cf6['length'];_0x5195a4<_0x5627fe;_0x5195a4++){_0x157b27+='%'+('00'+_0x387cf6['charCodeAt'](_0x5195a4)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x157b27);};_0x19ac['EJobha']=_0x28b94b,_0x4f6bd6=arguments,_0x19ac['DUomcY']=!![];}const _0x3f6f6a=_0x495e8e[0x0],_0x5f34f1=_0x48c20d+_0x3f6f6a,_0x3d9b84=_0x4f6bd6[_0x5f34f1];if(!_0x3d9b84){const _0x2dac9e=function(_0x11b452){this['NVcjVN']=_0x11b452,this['PHAqVF']=[0x1,0x0,0x0],this['ieFdHS']=function(){return'newState';},this['fzOYZS']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['qbHRCN']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2dac9e['prototype']['hwOmsU']=function(){const _0x2e3aa2=new RegExp(this['fzOYZS']+this['qbHRCN']),_0x3195ff=_0x2e3aa2['test'](this['ieFdHS']['toString']())?--this['PHAqVF'][0x1]:--this['PHAqVF'][0x0];return this['lGXqKJ'](_0x3195ff);},_0x2dac9e['prototype']['lGXqKJ']=function(_0x52a437){if(!Boolean(~_0x52a437))return _0x52a437;return this['fCMkdJ'](this['NVcjVN']);},_0x2dac9e['prototype']['fCMkdJ']=function(_0x3ac54c){for(let _0x442408=0x0,_0x51c928=this['PHAqVF']['length'];_0x442408<_0x51c928;_0x442408++){this['PHAqVF']['push'](Math['round'](Math['random']())),_0x51c928=this['PHAqVF']['length'];}return _0x3ac54c(this['PHAqVF'][0x0]);},new _0x2dac9e(_0x19ac)['hwOmsU'](),_0x4c138b=_0x19ac['EJobha'](_0x4c138b),_0x4f6bd6[_0x5f34f1]=_0x4c138b;}else _0x4c138b=_0x3d9b84;return _0x4c138b;},_0x19ac(_0x4f6bd6,_0x4537ad);}function constructRequestBody(_0x2bbdc3){const _0x265fa4=_0x14b27d,_0x2e1c7d={};_0x2e1c7d[_0x265fa4(0x22e)]=_0x265fa4(0x1fa);const _0x1f2c4a=_0x2e1c7d,_0x4577b8={};_0x4577b8[_0x265fa4(0x21e)]=GSB_CONFIG['clientId'],_0x4577b8[_0x265fa4(0x207)+_0x265fa4(0x23f)]=GSB_CONFIG[_0x265fa4(0x207)+_0x265fa4(0x23f)];const _0x175645={};_0x175645[_0x265fa4(0x239)]=_0x2bbdc3;const _0x5aba62={};_0x5aba62[_0x265fa4(0x225)+'s']=THREAT_TYPES,_0x5aba62['platformTy'+'pes']=PLATFORM_TYPES,_0x5aba62[_0x265fa4(0x20a)+_0x265fa4(0x1f1)]=[_0x1f2c4a['ppaJL']],_0x5aba62['threatEntr'+_0x265fa4(0x1ff)]=[_0x175645];const _0x2b9bb9={};return _0x2b9bb9[_0x265fa4(0x21b)]=_0x4577b8,_0x2b9bb9['threatInfo']=_0x5aba62,_0x2b9bb9;}