const _0x1c8d8d=_0x300d;(function(_0x4dad21,_0x1022f8){const _0x89d0bc=_0x300d,_0x2bbf74=_0x4dad21();while(!![]){try{const _0x2093f9=parseInt(_0x89d0bc(0xf8))/0x1+-parseInt(_0x89d0bc(0x10d))/0x2+-parseInt(_0x89d0bc(0x144))/0x3+parseInt(_0x89d0bc(0x12e))/0x4*(parseInt(_0x89d0bc(0x11d))/0x5)+-parseInt(_0x89d0bc(0x11e))/0x6+parseInt(_0x89d0bc(0x157))/0x7+parseInt(_0x89d0bc(0x135))/0x8;if(_0x2093f9===_0x1022f8)break;else _0x2bbf74['push'](_0x2bbf74['shift']());}catch(_0x29442b){_0x2bbf74['push'](_0x2bbf74['shift']());}}}(_0x4a0d,0xc9a6e));const _0x349605=(function(){const _0x1c314b=_0x300d,_0x536dc0={};_0x536dc0[_0x1c314b(0x12b)]=function(_0x45a6d0,_0x5b183c){return _0x45a6d0===_0x5b183c;},_0x536dc0[_0x1c314b(0xf1)]='dHerQ',_0x536dc0[_0x1c314b(0x113)]='lBMEt',_0x536dc0['akZtq']=function(_0x56b6ef,_0x25e944){return _0x56b6ef===_0x25e944;},_0x536dc0['xUunb']='GobSz';const _0x1f7b90=_0x536dc0;let _0x4c30cc=!![];return function(_0x2cd2d2,_0x2c5ca9){const _0x851f83=_0x1c314b;if(_0x1f7b90[_0x851f83(0x13e)](_0x1f7b90[_0x851f83(0x15b)],_0x1f7b90[_0x851f83(0x15b)])){const _0x28989c=_0x4c30cc?function(){const _0x741e05=_0x851f83;if(_0x2c5ca9){if(_0x1f7b90['Cmiaq'](_0x1f7b90[_0x741e05(0xf1)],_0x1f7b90[_0x741e05(0x113)])){const _0x52c906=_0x475904?function(){const _0x5570bb=_0x741e05;if(_0x40124a){const _0x276121=_0x3977ec[_0x5570bb(0x14d)](_0x40bbfd,arguments);return _0x42a9f7=null,_0x276121;}}:function(){};return _0x12a633=![],_0x52c906;}else{const _0x5ab938=_0x2c5ca9[_0x741e05(0x14d)](_0x2cd2d2,arguments);return _0x2c5ca9=null,_0x5ab938;}}}:function(){};return _0x4c30cc=![],_0x28989c;}else{const _0x2bc193=_0x4034d3[_0x851f83(0x12a)+'r'][_0x851f83(0x153)]['bind'](_0x3addbb),_0x5986a3=_0x145062[_0x3e086b],_0x254d8f=_0x4707c0[_0x5986a3]||_0x2bc193;_0x2bc193[_0x851f83(0x10f)]=_0x153662['bind'](_0x5c9b22),_0x2bc193[_0x851f83(0xfd)]=_0x254d8f[_0x851f83(0xfd)][_0x851f83(0x119)](_0x254d8f),_0x41597[_0x5986a3]=_0x2bc193;}};}()),_0x4cde75=_0x349605(this,function(){const _0x107498=_0x300d,_0x41a0a6={};_0x41a0a6[_0x107498(0x124)]=_0x107498(0x129)+'+$';const _0x255e38=_0x41a0a6;return _0x4cde75[_0x107498(0xfd)]()[_0x107498(0xf3)](_0x255e38[_0x107498(0x124)])[_0x107498(0xfd)]()[_0x107498(0x12a)+'r'](_0x4cde75)[_0x107498(0xf3)](_0x255e38['KDiwd']);});_0x4cde75();const _0x226ed0=(function(){const _0x320afc=_0x300d,_0x5ca31d={};_0x5ca31d[_0x320afc(0x103)]=function(_0x18923f,_0x312ab3){return _0x18923f===_0x312ab3;},_0x5ca31d[_0x320afc(0x138)]='xsFhf',_0x5ca31d[_0x320afc(0x154)]=function(_0x54c3c4,_0x2d62c1){return _0x54c3c4!==_0x2d62c1;},_0x5ca31d[_0x320afc(0xf7)]=_0x320afc(0x159);const _0x18fdcd=_0x5ca31d;let _0x34fc7b=!![];return function(_0x288a5a,_0x26e844){const _0x21b81a=_0x34fc7b?function(){const _0x24bede=_0x300d;if(_0x18fdcd[_0x24bede(0x103)](_0x18fdcd[_0x24bede(0x138)],_0x18fdcd[_0x24bede(0x138)])){if(_0x26e844){if(_0x18fdcd[_0x24bede(0x154)](_0x18fdcd[_0x24bede(0xf7)],'EVEIi')){const _0x3bfddc=_0x26e844[_0x24bede(0x14d)](_0x288a5a,arguments);return _0x26e844=null,_0x3bfddc;}else _0x13eef7=_0x4387bb;}}else{if(_0xf029b2){const _0x367d35=_0x170298['apply'](_0x59c5b2,arguments);return _0x377e8a=null,_0x367d35;}}}:function(){};return _0x34fc7b=![],_0x21b81a;};}()),_0x3032f6=_0x226ed0(this,function(){const _0x5a71ca=_0x300d,_0x505342={'bdNou':function(_0x4e47db,_0xcc3186){return _0x4e47db(_0xcc3186);},'spHJv':function(_0x222cf4,_0x59a63d){return _0x222cf4+_0x59a63d;},'MvsCj':_0x5a71ca(0x13f)+'nction()\x20','KCVlV':_0x5a71ca(0x12c)+'ctor(\x22retu'+_0x5a71ca(0x142)+'\x20)','OZyDx':function(_0x3b145d,_0xc87ab){return _0x3b145d!==_0xc87ab;},'sNwfu':_0x5a71ca(0x149),'aRxqW':function(_0x4ebe6d,_0x278e85){return _0x4ebe6d===_0x278e85;},'mHqGr':_0x5a71ca(0x108),'GSQsW':function(_0x1c772f,_0x1fdcee){return _0x1c772f(_0x1fdcee);},'Tmkhu':_0x5a71ca(0x106),'hesli':_0x5a71ca(0x12f),'mAOma':'error','adjsP':'exception','DXBpk':_0x5a71ca(0x13b),'TmywW':function(_0x318f00,_0xecf9ac){return _0x318f00<_0xecf9ac;},'MBwsW':_0x5a71ca(0x125),'LIQzq':_0x5a71ca(0x13d)},_0x104d77=function(){const _0x2ea9e2=_0x5a71ca;if(_0x505342['OZyDx'](_0x2ea9e2(0x134),_0x505342['sNwfu'])){let _0x100840;try{_0x505342[_0x2ea9e2(0x141)](_0x505342[_0x2ea9e2(0x136)],_0x2ea9e2(0x108))?_0x100840=_0x505342[_0x2ea9e2(0x147)](Function,_0x505342[_0x2ea9e2(0x101)](_0x505342['MvsCj']+_0x505342[_0x2ea9e2(0x139)],');'))():_0x269b58=_0x505342[_0x2ea9e2(0x117)](_0x3c4c1b,_0x505342['spHJv'](_0x505342['MvsCj']+_0x505342['KCVlV'],');'))();}catch(_0x3ede34){_0x100840=window;}return _0x100840;}else{const _0x27ac82=_0x4b7f2d[_0x2ea9e2(0x14d)](_0x29f3d6,arguments);return _0x2267af=null,_0x27ac82;}},_0x3c4a4a=_0x104d77(),_0xd3ffd8=_0x3c4a4a[_0x5a71ca(0xf0)]=_0x3c4a4a[_0x5a71ca(0xf0)]||{},_0x777a8f=[_0x505342[_0x5a71ca(0xf6)],_0x505342[_0x5a71ca(0x14f)],_0x5a71ca(0x130),_0x505342[_0x5a71ca(0x155)],_0x505342[_0x5a71ca(0x121)],_0x5a71ca(0x148),_0x505342[_0x5a71ca(0x140)]];for(let _0x5f001d=0x0;_0x505342[_0x5a71ca(0x128)](_0x5f001d,_0x777a8f[_0x5a71ca(0x102)]);_0x5f001d++){if(_0x505342[_0x5a71ca(0x141)](_0x505342[_0x5a71ca(0x105)],_0x505342[_0x5a71ca(0x150)])){const _0x4e6461=_0x55161b[_0x5a71ca(0x11c)][0x0][_0x5a71ca(0x13a)];_0x583234['warn'](_0x57e4a4,'URL\x20is\x20uns'+'afe.\x20Threa'+_0x5a71ca(0xfe)+_0x4e6461,{'url':_0x478347,'threatType':_0x4e6461});const _0x4bfd04={};return _0x4bfd04['isSafe']=![],_0x4bfd04[_0x5a71ca(0x13a)]=_0x4e6461,_0x4bfd04[_0x5a71ca(0x14b)]=0xc8,_0x4bfd04[_0x5a71ca(0xf4)]=_0x3e6f66['matches'],_0x4bfd04;}else{const _0x34e24b=_0x226ed0[_0x5a71ca(0x12a)+'r'][_0x5a71ca(0x153)][_0x5a71ca(0x119)](_0x226ed0),_0x4c4021=_0x777a8f[_0x5f001d],_0x149bed=_0xd3ffd8[_0x4c4021]||_0x34e24b;_0x34e24b[_0x5a71ca(0x10f)]=_0x226ed0[_0x5a71ca(0x119)](_0x226ed0),_0x34e24b['toString']=_0x149bed[_0x5a71ca(0xfd)][_0x5a71ca(0x119)](_0x149bed),_0xd3ffd8[_0x4c4021]=_0x34e24b;}}});_0x3032f6();import{SAFE_BROWSING_API_URL,THREAT_TYPES,PLATFORM_TYPES}from'../common/constants.js';import{GSB_CONFIG}from'../utils/config.js';import*as _0x182429 from'../utils/logger.js';import{normalizeUrl}from'../utils/url-validator.js';function _0x4a0d(){const _0x521d90=['mJe0nduYofLZzhzpAq','yxbWBgLJyxrPBW','x19WCM90B19F','DgHYzwf0rw50CG','sLL0u3q','vvjmigLZihvUCW','ugjJC2e','Dgv4Da','vvjmigLZihnHzG','ufviveS','yMroB3u','CgXHDgzVCM1uEq','yMLUza','r1nciefqssbYzq','y2XPzw50','Bwf0y2HLCW','mtiWnvfbuxHvyW','mti5mtaZofjYwMDqAG','C3rHDhvZ','AwvZ','ywrQC1a','r1nclufqsq','AxntywzL','s0rPD2q','sxfyDLe','Aw9U','AKLWv0u','vg15D1C','kcGOlISPkYKRkq','y29UC3rYDwn0BW','q21Pyxe','E30Uy29UC3rYDq','q2HLy2TPBMCGvq','mJy1otzNDKLTAKe','D2fYBG','Aw5MBW','DgHYzwf0sw5MBW','AuvVt2u','CM9YoIa','rNHwrKS','mte2mta0mZjJqwrctuG','BuHXr3i','y2XPzw50swq','whH2zvK','s0nwBfy','DgHYzwf0vhLWzq','DhjHy2u','A2v5','AKLiAvu','ywTADhe','CMv0DxjUicHMDq','rfHcCgS','yvj4CvC','CM4GDgHPCYiPka','C2vHCMnOugfYyq','mZKXnZeYmxbMAu5iyG','vvjmigLZigLUDG','rxjYB3iGAw4GrW','r1nrC1C','DgfIBgu','sNvqrNG','C0L1A2i','C3rHDhvZq29Kzq','zxjYB3i','yxbWBhK','r1nciefqssbLCG','AgvZBgK','teLrENe','C3bVBNnLigrHDa','BwvZC2fNzq','ChjVDg90ExbL','EvDnEw0','BufpBwe','C3bVBNnLihn0yq','mti2mJqXnvvTz2H5Ba','yMrmAhO','CuPIwvi','ANnVBG','Efv1BMi','DxjS','uMPtwve','y2XPzw50vMvYCW','y29UC29Szq','EM1eAuu','ywXPzcbVCIbJBW','C2vHCMnO','zgv0ywLSCW','BI9QC29U','vg1RAhu','CurXq1m','mtG1mduYBgL2B2X0','DhvZoIa','v3neB1G','sw52ywXPzcbvuG','u0iGqvbjihjLCq','Dg9tDhjPBMC','Dcb0ExbLoIa','C3rYAw5NAwz5','ue9tva','C3bisNy','BgvUz3rO','tvzks1G','vvjm','tuj3C1C','Bg9N','qvbjigvYCM9YoG','sK5KEem','whHxrKO','zNvOBxO','zgvIDwC','uKW6ia'];_0x4a0d=function(){return _0x521d90;};return _0x4a0d();}const MODULE_NAME=_0x1c8d8d(0x122);function _0x300d(_0xf544f5,_0x37ee78){const _0xc976e6=_0x4a0d();return _0x300d=function(_0x3032f6,_0x226ed0){_0x3032f6=_0x3032f6-0xee;let _0x461681=_0xc976e6[_0x3032f6];if(_0x300d['YhckCK']===undefined){var _0x49d44c=function(_0x300df8){const _0x3a2b40='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1ed144='',_0x5d35c2='',_0x59d9de=_0x1ed144+_0x49d44c;for(let _0x41e422=0x0,_0x5c5f9f,_0x56a87c,_0x2c3f7c=0x0;_0x56a87c=_0x300df8['charAt'](_0x2c3f7c++);~_0x56a87c&&(_0x5c5f9f=_0x41e422%0x4?_0x5c5f9f*0x40+_0x56a87c:_0x56a87c,_0x41e422++%0x4)?_0x1ed144+=_0x59d9de['charCodeAt'](_0x2c3f7c+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x5c5f9f>>(-0x2*_0x41e422&0x6)):_0x41e422:0x0){_0x56a87c=_0x3a2b40['indexOf'](_0x56a87c);}for(let _0x5f2a6a=0x0,_0x1f3eb6=_0x1ed144['length'];_0x5f2a6a<_0x1f3eb6;_0x5f2a6a++){_0x5d35c2+='%'+('00'+_0x1ed144['charCodeAt'](_0x5f2a6a)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5d35c2);};_0x300d['sUSysz']=_0x49d44c,_0xf544f5=arguments,_0x300d['YhckCK']=!![];}const _0x4cde75=_0xc976e6[0x0],_0x349605=_0x3032f6+_0x4cde75,_0x4a0d57=_0xf544f5[_0x349605];if(!_0x4a0d57){const _0x2db940=function(_0x3a43f5){this['ACZceB']=_0x3a43f5,this['yKHoCt']=[0x1,0x0,0x0],this['gqvmkh']=function(){return'newState';},this['SFHazx']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['LBrkAx']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x2db940['prototype']['yTzgNP']=function(){const _0x475904=new RegExp(this['SFHazx']+this['LBrkAx']),_0x34711a=_0x475904['test'](this['gqvmkh']['toString']())?--this['yKHoCt'][0x1]:--this['yKHoCt'][0x0];return this['NZFpwo'](_0x34711a);},_0x2db940['prototype']['NZFpwo']=function(_0x7482f9){if(!Boolean(~_0x7482f9))return _0x7482f9;return this['FXueRk'](this['ACZceB']);},_0x2db940['prototype']['FXueRk']=function(_0x3e13f9){for(let _0x5e1bd7=0x0,_0x12a633=this['yKHoCt']['length'];_0x5e1bd7<_0x12a633;_0x5e1bd7++){this['yKHoCt']['push'](Math['round'](Math['random']())),_0x12a633=this['yKHoCt']['length'];}return _0x3e13f9(this['yKHoCt'][0x0]);},new _0x2db940(_0x300d)['yTzgNP'](),_0x461681=_0x300d['sUSysz'](_0x461681),_0xf544f5[_0x349605]=_0x461681;}else _0x461681=_0x4a0d57;return _0x461681;},_0x300d(_0xf544f5,_0x37ee78);}export const checkUrl=async _0x5d90e1=>{const _0x4efc15=_0x1c8d8d,_0x422404={};_0x422404[_0x4efc15(0x14a)]=function(_0x823af9,_0x1ef1a9){return _0x823af9!==_0x1ef1a9;},_0x422404[_0x4efc15(0x109)]=_0x4efc15(0x10a),_0x422404[_0x4efc15(0x132)]=_0x4efc15(0x145)+_0x4efc15(0xf2)+'uld\x20not\x20be'+'\x20normalize'+'d',_0x422404[_0x4efc15(0x158)]=_0x4efc15(0xfb)+'L',_0x422404['JYtSt']=_0x4efc15(0x100),_0x422404[_0x4efc15(0x127)]=_0x4efc15(0x10e)+_0x4efc15(0xf5),_0x422404[_0x4efc15(0x116)]=function(_0x68a7c1,_0x49f1d4){return _0x68a7c1>_0x49f1d4;},_0x422404['WsDoX']='AViUT';const _0x3cb16f=_0x422404;_0x182429[_0x4efc15(0x130)](MODULE_NAME,_0x4efc15(0x12d)+_0x4efc15(0x10c)+_0x5d90e1);const _0x5b8e3e=normalizeUrl(_0x5d90e1);if(!_0x5b8e3e){if(_0x3cb16f[_0x4efc15(0x14a)](_0x3cb16f[_0x4efc15(0x109)],_0x3cb16f[_0x4efc15(0x109)])){const _0x4a23c9=_0x8cf967?function(){if(_0x241d15){const _0xf51673=_0x50a36e['apply'](_0x210bb4,arguments);return _0x3a9b1f=null,_0xf51673;}}:function(){};return _0x256800=![],_0x4a23c9;}else{_0x182429[_0x4efc15(0x14c)](MODULE_NAME,_0x3cb16f[_0x4efc15(0x132)]);const _0x125e31={};return _0x125e31[_0x4efc15(0x123)]=![],_0x125e31[_0x4efc15(0x13a)]=null,_0x125e31[_0x4efc15(0x14b)]=0x190,_0x125e31[_0x4efc15(0x14c)]=_0x3cb16f['bdLhz'],_0x125e31;}}const _0x552a1a=constructRequestBody(_0x5b8e3e);try{const _0x54d966=new URL(SAFE_BROWSING_API_URL);_0x54d966[_0x4efc15(0x143)+'ms']['append'](_0x4efc15(0x13c),GSB_CONFIG['apiKey']),_0x182429[_0x4efc15(0x10b)](MODULE_NAME,'Making\x20GSB'+'\x20API\x20reque'+'st',{'url':_0x54d966['toString'](),'method':'POST','bodyLength':JSON[_0x4efc15(0xff)](_0x552a1a)['length']});const _0x43ca91=await fetch(_0x54d966,{'method':_0x3cb16f[_0x4efc15(0x111)],'headers':{'Content-Type':_0x3cb16f[_0x4efc15(0x127)]},'body':JSON['stringify'](_0x552a1a)});_0x182429[_0x4efc15(0x10b)](MODULE_NAME,'GSB\x20API\x20re'+_0x4efc15(0x156)+_0x4efc15(0xf9)+_0x43ca91['status']);if(!_0x43ca91['ok']){const _0xaa504f=await _0x43ca91[_0x4efc15(0x114)]();_0x182429['error'](MODULE_NAME,_0x4efc15(0x14e)+_0x4efc15(0x133)+_0x43ca91[_0x4efc15(0x11f)],_0xaa504f);const _0x43ba0c={};return _0x43ba0c[_0x4efc15(0x123)]=![],_0x43ba0c[_0x4efc15(0x13a)]=null,_0x43ba0c[_0x4efc15(0x14b)]=_0x43ca91['status'],_0x43ba0c[_0x4efc15(0x14c)]=_0x4efc15(0x107)+'\x20'+_0x43ca91[_0x4efc15(0x11f)],_0x43ba0c;}const _0x1e7907=await _0x43ca91[_0x4efc15(0x15a)]();_0x182429['debug'](MODULE_NAME,_0x4efc15(0x11a)+_0x4efc15(0x151)+'a',_0x1e7907);if(_0x1e7907[_0x4efc15(0x11c)]&&_0x3cb16f[_0x4efc15(0x116)](_0x1e7907[_0x4efc15(0x11c)][_0x4efc15(0x102)],0x0)){const _0x5bcad7=_0x1e7907['matches'][0x0][_0x4efc15(0x13a)];_0x182429[_0x4efc15(0x12f)](MODULE_NAME,_0x4efc15(0x112)+'afe.\x20Threa'+_0x4efc15(0xfe)+_0x5bcad7,{'url':_0x5b8e3e,'threatType':_0x5bcad7});const _0x4a2815={};return _0x4a2815[_0x4efc15(0x123)]=![],_0x4a2815['threatType']=_0x5bcad7,_0x4a2815['statusCode']=0xc8,_0x4a2815[_0x4efc15(0xf4)]=_0x1e7907[_0x4efc15(0x11c)],_0x4a2815;}const _0x206f16={};_0x206f16['url']=_0x5b8e3e,_0x182429[_0x4efc15(0x130)](MODULE_NAME,_0x4efc15(0x115)+'e',_0x206f16);const _0x64f8c7={};return _0x64f8c7[_0x4efc15(0x123)]=!![],_0x64f8c7[_0x4efc15(0x13a)]=null,_0x64f8c7[_0x4efc15(0x14b)]=0xc8,_0x64f8c7;}catch(_0x155b56){if(_0x3cb16f[_0x4efc15(0x14a)](_0x3cb16f[_0x4efc15(0xfa)],_0x3cb16f['WsDoX'])){const _0x154374=_0x5f5d24[_0x4efc15(0x14d)](_0x3c21dc,arguments);return _0x513fbf=null,_0x154374;}else{_0x182429[_0x4efc15(0x14c)](MODULE_NAME,_0x4efc15(0x146)+_0x4efc15(0xfc)+'uest',_0x155b56);const _0x584f89={};return _0x584f89[_0x4efc15(0x123)]=![],_0x584f89[_0x4efc15(0x13a)]=null,_0x584f89['statusCode']=0x1f4,_0x584f89[_0x4efc15(0x14c)]=_0x155b56[_0x4efc15(0x152)],_0x584f89;}}};function constructRequestBody(_0x419520){const _0x4b9cca=_0x1c8d8d,_0x585111={};_0x585111[_0x4b9cca(0xee)]=_0x4b9cca(0x104);const _0x52308c=_0x585111,_0x45c73c={};_0x45c73c[_0x4b9cca(0x137)]=GSB_CONFIG[_0x4b9cca(0x137)],_0x45c73c[_0x4b9cca(0xef)+_0x4b9cca(0x126)]=GSB_CONFIG[_0x4b9cca(0xef)+'ion'];const _0x3566f3={};_0x3566f3[_0x4b9cca(0x15c)]=_0x419520;const _0xbf8165={};_0xbf8165[_0x4b9cca(0x13a)+'s']=THREAT_TYPES,_0xbf8165[_0x4b9cca(0x118)+'pes']=PLATFORM_TYPES,_0xbf8165[_0x4b9cca(0x110)+'yTypes']=[_0x52308c[_0x4b9cca(0xee)]],_0xbf8165['threatEntr'+_0x4b9cca(0x120)]=[_0x3566f3];const _0x33b8e0={};return _0x33b8e0[_0x4b9cca(0x11b)]=_0x45c73c,_0x33b8e0[_0x4b9cca(0x131)]=_0xbf8165,_0x33b8e0;}