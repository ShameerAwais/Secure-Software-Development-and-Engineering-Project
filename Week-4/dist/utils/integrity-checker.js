const _0x1be164=_0x49ea;(function(_0xa4c65f,_0x43232f){const _0xa30142=_0x49ea,_0x386694=_0xa4c65f();while(!![]){try{const _0x2de8f3=parseInt(_0xa30142(0x216))/0x1+parseInt(_0xa30142(0x23a))/0x2+-parseInt(_0xa30142(0x268))/0x3*(-parseInt(_0xa30142(0x25e))/0x4)+-parseInt(_0xa30142(0x240))/0x5*(parseInt(_0xa30142(0x208))/0x6)+parseInt(_0xa30142(0x211))/0x7*(parseInt(_0xa30142(0x20d))/0x8)+-parseInt(_0xa30142(0x21a))/0x9*(-parseInt(_0xa30142(0x224))/0xa)+-parseInt(_0xa30142(0x241))/0xb;if(_0x2de8f3===_0x43232f)break;else _0x386694['push'](_0x386694['shift']());}catch(_0x27b767){_0x386694['push'](_0x386694['shift']());}}}(_0xeeb3,0x4ede5));function _0x49ea(_0x3525d3,_0x1688f3){const _0x3e24ad=_0xeeb3();return _0x49ea=function(_0x42c646,_0x541731){_0x42c646=_0x42c646-0x1e4;let _0x447826=_0x3e24ad[_0x42c646];if(_0x49ea['idpBJQ']===undefined){var _0x1d1a74=function(_0x49ea8f){const _0x22c7f8='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x19c515='',_0x234770='',_0x5a22a1=_0x19c515+_0x1d1a74;for(let _0x1d8205=0x0,_0x535ee8,_0x5af0e2,_0x1d976a=0x0;_0x5af0e2=_0x49ea8f['charAt'](_0x1d976a++);~_0x5af0e2&&(_0x535ee8=_0x1d8205%0x4?_0x535ee8*0x40+_0x5af0e2:_0x5af0e2,_0x1d8205++%0x4)?_0x19c515+=_0x5a22a1['charCodeAt'](_0x1d976a+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x535ee8>>(-0x2*_0x1d8205&0x6)):_0x1d8205:0x0){_0x5af0e2=_0x22c7f8['indexOf'](_0x5af0e2);}for(let _0x4ae337=0x0,_0x489f39=_0x19c515['length'];_0x4ae337<_0x489f39;_0x4ae337++){_0x234770+='%'+('00'+_0x19c515['charCodeAt'](_0x4ae337)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x234770);};_0x49ea['kNteyc']=_0x1d1a74,_0x3525d3=arguments,_0x49ea['idpBJQ']=!![];}const _0x116d4d=_0x3e24ad[0x0],_0x1aed4d=_0x42c646+_0x116d4d,_0xeeb3f6=_0x3525d3[_0x1aed4d];if(!_0xeeb3f6){const _0x3f7f5c=function(_0x443dfd){this['YvcvBj']=_0x443dfd,this['ylvWDk']=[0x1,0x0,0x0],this['WginEX']=function(){return'newState';},this['rJvENy']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['fvZmvW']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x3f7f5c['prototype']['EYpTNn']=function(){const _0xfb9dfc=new RegExp(this['rJvENy']+this['fvZmvW']),_0x8990b6=_0xfb9dfc['test'](this['WginEX']['toString']())?--this['ylvWDk'][0x1]:--this['ylvWDk'][0x0];return this['rAMrpj'](_0x8990b6);},_0x3f7f5c['prototype']['rAMrpj']=function(_0x41ed8e){if(!Boolean(~_0x41ed8e))return _0x41ed8e;return this['vZbWGg'](this['YvcvBj']);},_0x3f7f5c['prototype']['vZbWGg']=function(_0xbc1d23){for(let _0x29300c=0x0,_0x102376=this['ylvWDk']['length'];_0x29300c<_0x102376;_0x29300c++){this['ylvWDk']['push'](Math['round'](Math['random']())),_0x102376=this['ylvWDk']['length'];}return _0xbc1d23(this['ylvWDk'][0x0]);},new _0x3f7f5c(_0x49ea)['EYpTNn'](),_0x447826=_0x49ea['kNteyc'](_0x447826),_0x3525d3[_0x1aed4d]=_0x447826;}else _0x447826=_0xeeb3f6;return _0x447826;},_0x49ea(_0x3525d3,_0x1688f3);}const _0x1aed4d=(function(){let _0x23d053=!![];return function(_0x2ed172,_0x8d3a26){const _0x58554b=_0x23d053?function(){const _0x22747a=_0x49ea;if(_0x8d3a26){const _0x52e09e=_0x8d3a26[_0x22747a(0x1f0)](_0x2ed172,arguments);return _0x8d3a26=null,_0x52e09e;}}:function(){};return _0x23d053=![],_0x58554b;};}()),_0x116d4d=_0x1aed4d(this,function(){const _0x5d59b7=_0x49ea,_0x1c41e4={};_0x1c41e4['IyrvF']=_0x5d59b7(0x231)+'+$';const _0x2bd639=_0x1c41e4;return _0x116d4d['toString']()[_0x5d59b7(0x252)](_0x2bd639[_0x5d59b7(0x244)])[_0x5d59b7(0x24d)]()['constructo'+'r'](_0x116d4d)[_0x5d59b7(0x252)](_0x2bd639[_0x5d59b7(0x244)]);});_0x116d4d();const _0x541731=(function(){let _0x12dd45=!![];return function(_0xa05e7,_0x3bbf55){const _0x481311=_0x12dd45?function(){if(_0x3bbf55){const _0x153217=_0x3bbf55['apply'](_0xa05e7,arguments);return _0x3bbf55=null,_0x153217;}}:function(){};return _0x12dd45=![],_0x481311;};}()),_0x42c646=_0x541731(this,function(){const _0x282384=_0x49ea,_0x3d8b32={'mfeua':function(_0x43007e,_0xf5315){return _0x43007e(_0xf5315);},'Crsht':function(_0x5f99f3,_0x39ddff){return _0x5f99f3+_0x39ddff;},'mAriX':'return\x20(fu'+_0x282384(0x267),'AtElQ':function(_0x503a7d){return _0x503a7d();},'UxEtK':_0x282384(0x21d),'sAraC':_0x282384(0x212),'wiCGS':_0x282384(0x23e),'aZNAQ':_0x282384(0x263),'OlHyl':_0x282384(0x21e),'wNLvn':function(_0x1e4d30,_0x57e1a6){return _0x1e4d30<_0x57e1a6;}},_0x199d6d=function(){const _0x3f5795=_0x282384;let _0x1d9dfa;try{_0x1d9dfa=_0x3d8b32[_0x3f5795(0x269)](Function,_0x3d8b32[_0x3f5795(0x20b)](_0x3d8b32['Crsht'](_0x3d8b32[_0x3f5795(0x215)],_0x3f5795(0x264)+'ctor(\x22retu'+_0x3f5795(0x205)+'\x20)'),');'))();}catch(_0x3a8508){_0x1d9dfa=window;}return _0x1d9dfa;},_0x16774b=_0x3d8b32['AtElQ'](_0x199d6d),_0x353cea=_0x16774b['console']=_0x16774b[_0x282384(0x251)]||{},_0x4798ff=[_0x282384(0x258),_0x3d8b32[_0x282384(0x209)],_0x3d8b32[_0x282384(0x1ee)],_0x3d8b32[_0x282384(0x1fc)],_0x282384(0x26a),_0x3d8b32[_0x282384(0x239)],_0x3d8b32[_0x282384(0x225)]];for(let _0x1ca041=0x0;_0x3d8b32[_0x282384(0x207)](_0x1ca041,_0x4798ff[_0x282384(0x233)]);_0x1ca041++){const _0x508f0b=_0x541731[_0x282384(0x1f9)+'r'][_0x282384(0x219)]['bind'](_0x541731),_0xc006d7=_0x4798ff[_0x1ca041],_0x5ddcbd=_0x353cea[_0xc006d7]||_0x508f0b;_0x508f0b[_0x282384(0x1f7)]=_0x541731[_0x282384(0x24c)](_0x541731),_0x508f0b[_0x282384(0x24d)]=_0x5ddcbd[_0x282384(0x24d)][_0x282384(0x24c)](_0x5ddcbd),_0x353cea[_0xc006d7]=_0x508f0b;}});_0x42c646();import*as _0x5452dc from'./logger.js';import*as _0x1caeb6 from'./secure-storage.js';const MODULE_NAME=_0x1be164(0x24a)+_0x1be164(0x25f),INTEGRITY_KEY=_0x1be164(0x22d)+_0x1be164(0x24e)+_0x1be164(0x1eb),CRITICAL_FILES=['background'+_0x1be164(0x22a)+_0x1be164(0x247),'background'+'/gsb-api.j'+'s',_0x1be164(0x1fb)+'ntent.js',_0x1be164(0x21c)+_0x1be164(0x255)+_0x1be164(0x1f4)];async function calculateHash(_0x2fc7ee){const _0x1cb432=_0x1be164,_0x2ea2bb={};_0x2ea2bb[_0x1cb432(0x250)]=_0x1cb432(0x254)+_0x1cb432(0x22c)+_0x1cb432(0x218)+'ed',_0x2ea2bb['NCDcy']=function(_0x477897,_0x33df33){return _0x477897!==_0x33df33;},_0x2ea2bb['gTApi']='CFGbS',_0x2ea2bb[_0x1cb432(0x1f3)]='NgvTG',_0x2ea2bb[_0x1cb432(0x23b)]=_0x1cb432(0x26c),_0x2ea2bb[_0x1cb432(0x249)]='Error\x20calc'+_0x1cb432(0x248)+'sh';const _0x56ae48=_0x2ea2bb;try{if(_0x56ae48[_0x1cb432(0x214)](_0x56ae48['gTApi'],_0x56ae48[_0x1cb432(0x1f3)])){const _0x383b5d=new TextEncoder(),_0x4d5443=_0x383b5d[_0x1cb432(0x201)](_0x2fc7ee),_0x279285=await crypto[_0x1cb432(0x1ff)]['digest'](_0x56ae48[_0x1cb432(0x23b)],_0x4d5443);return Array[_0x1cb432(0x217)](new Uint8Array(_0x279285))['map'](_0x3004e7=>_0x3004e7['toString'](0x10)['padStart'](0x2,'0'))[_0x1cb432(0x236)]('');}else{const _0x4a8b31={};_0x4a8b31[_0x1cb432(0x1f5)]=_0x367d4a,_0xfea62a['warn'](_0xda969d,_0x56ae48[_0x1cb432(0x250)],_0x4a8b31);}}catch(_0x46fea3){_0x5452dc['error'](MODULE_NAME,_0x56ae48['XVMDe'],_0x46fea3);throw _0x46fea3;}}async function getFileContent(_0x2a41dd){const _0x521799=_0x1be164,_0x2de47b={'qaNFL':function(_0x26a7fd,_0x439c74){return _0x26a7fd(_0x439c74);}};try{const _0x19de42=await _0x2de47b[_0x521799(0x25b)](fetch,chrome[_0x521799(0x23f)][_0x521799(0x203)](_0x521799(0x234)+_0x2a41dd));if(!_0x19de42['ok'])throw new Error(_0x521799(0x22b)+'load\x20file:'+'\x20'+_0x2a41dd);return await _0x19de42[_0x521799(0x1fa)]();}catch(_0x470c8d){return _0x5452dc['error'](MODULE_NAME,_0x521799(0x1ec)+_0x521799(0x200)+_0x2a41dd,_0x470c8d),'';}}function _0xeeb3(){const _0x4a4a65=['yxrPBMCGBMv3ia','AgfZAa','rxjYB3iGBg9Hza','r1blyNq','C0fYyum','rwHVue0','yxbWBhK','rxjYB3iGDMvYAq','BwfZDgvYsgfZAa','Der5BgG','lMPZ','AxnZDwvZ','uMvdCuC','x19WCM90B19F','z0fMu1C','y29UC3rYDwn0BW','Dgv4Da','y29UDgvUDc9JBW','D2Ldr1m','DMfSDwvZ','rxjYB3iGzhvYAq','C3vIDgXL','Aw5NigzPBgu6ia','zw5JB2rL','tePqugi','z2v0vvjm','suqGBwLZBwf0yW','CM4GDgHPCYiPka','yvHyCKW','D05mDM4','mZi0sMDREu92','vxHfDeS','ChvZAa','q3jZAhq','tM8GAw50zwDYAq','nJe5ndrkvu5nvLm','rKvnAeO','zNvSBhK','zMLSzxmGAgf2zq','mtyXt2vhAhrK','Aw5MBW','Bg9jA08','tKney3K','BufYAvG','mZe5nJeYvw55EffP','zNjVBq','y2HLy2SGzMfPBa','ChjVDg90ExbL','nJK0nZq2Befgr0vv','y3jPDgLJywWGzG','DxrPBhmVC2vJDq','D2fYBG','DhjHy2u','igLUDgvNCML0Eq','DhKGDMvYAwzPyW','DhLTEuC','zNLPBMCGAw50zq','Dw5KlcbNzw5LCG','mZbUDenMz2O','t2XiEwW','C2vJDxjLuMvTBW','B25L','C2vJDxjLr2v0','tKfbBvK','l2jHy2TNCM91BG','rMfPBgvKihrVia','Aw50zwDYAxr5ia','zxH0zw5ZAw9UxW','r2vUzxjHDgLUzW','DfPozLa','C3rHDguGC3rVCG','kcGOlISPkYKRkq','zgvIDwC','BgvUz3rO','C3jJlW','ugLlzue','AM9PBG','zxH0zw5ZAw9Usq','rMLSzsbTB2rPzG','yvPoqve','mtiYmZeZnNf5D0DJvq','qvnYu1G','AxnwywXPza','DhrPBMCGAw50zq','zxjYB3i','CNvUDgLTzq','mtq0mdbADuPLvNm','mte5mtm0otviBvfXsge','C3rHDguGCMvZzq','uKnfDuy','sxLYDKy','Eu1Su0W','yxrPB246ia','zc5QCW','DwXHDgLUzYbOyq','wfznrgu','sw50zwDYAxr5qW','CffPvuu','yMLUza','Dg9tDhjPBMC','Aw50zwDYAxr5xW','BMCGAw50zwDYAq','tuLWrNq','y29UC29Szq','C2vHCMnO','AwvKoIa','rxH0zw5ZAw9Uia','CMuTC3rVCMfNzq','zMLLza','vNLvuu8','Bg9N','AwXLCW','Awrztvm','CwforKW','Aw50zwDYAxr5','C2vJDxjLu2v0','mJy4nePPsu9dwa','AgvJA2vY','zwqGC3vJy2vZCW','rxjYB3iGCMvZzq','Axr5ihn0yxrL','DgfIBgu','E30Uy29UC3rYDq','igHHC2GGzM9Yia','DcbZDwnJzxnZzG','BMn0Aw9UkcKG','otG3Durxs2jp','BwzLDwe','zxHJzxb0Aw9U','ChnjqwK','u0Hblti1nG','yxrLza','zgnlA0W','sw50zwDYAxr5ia','EM1vu1O','DwnJzxnZzNvSBa','DhKGAgfZAcbMBW'];_0xeeb3=function(){return _0x4a4a65;};return _0xeeb3();}async function generateIntegrityHash(){const _0x2869bc=_0x1be164,_0x2924c9={'thpti':_0x2869bc(0x22e)+_0x2869bc(0x21f)+_0x2869bc(0x265)+_0x2869bc(0x21b)+_0x2869bc(0x259),'pywXl':function(_0x382776,_0x13e57e){return _0x382776(_0x13e57e);},'ReCqG':function(_0x21ec55,_0x43cc83){return _0x21ec55!==_0x43cc83;},'VyUQO':_0x2869bc(0x206),'GPKbt':_0x2869bc(0x1e6)+'hash\x20gener'+_0x2869bc(0x1e4)};_0x5452dc[_0x2869bc(0x232)](MODULE_NAME,_0x2924c9['thpti']);const _0x283e18={};for(const _0x1ef0d6 of CRITICAL_FILES){const _0xc19b8b=await _0x2924c9['pywXl'](getFileContent,_0x1ef0d6);if(_0xc19b8b){if(_0x2924c9[_0x2869bc(0x1f6)]('KxYuR',_0x2924c9[_0x2869bc(0x257)]))_0x283e18[_0x1ef0d6]=await calculateHash(_0xc19b8b);else{if(_0xd82d3f){const _0x237785=_0x1d82b3[_0x2869bc(0x1f0)](_0x10d415,arguments);return _0x4de515=null,_0x237785;}}}}_0x283e18[_0x2869bc(0x237)+'d']=chrome[_0x2869bc(0x23f)]['id'];const _0x81acac=Object[_0x2869bc(0x1fd)](_0x283e18)['join']('|');return _0x283e18[_0x2869bc(0x1f2)]=await calculateHash(_0x81acac),_0x5452dc[_0x2869bc(0x232)](MODULE_NAME,_0x2924c9[_0x2869bc(0x1ed)],_0x283e18),_0x283e18;}export async function storeIntegrityState(){const _0x202e8e=_0x1be164,_0x474126={'loIkO':function(_0x39e433){return _0x39e433();},'FEMhJ':_0x202e8e(0x1e6)+_0x202e8e(0x230)+_0x202e8e(0x260)+_0x202e8e(0x20f)};try{const _0x30bcab=await _0x474126[_0x202e8e(0x213)](generateIntegrityHash);await _0x1caeb6[_0x202e8e(0x25d)](INTEGRITY_KEY,_0x30bcab),_0x5452dc[_0x202e8e(0x212)](MODULE_NAME,_0x474126[_0x202e8e(0x20e)]);}catch(_0x13dbdd){_0x5452dc[_0x202e8e(0x23e)](MODULE_NAME,'Error\x20stor'+'ing\x20integr'+_0x202e8e(0x262),_0x13dbdd);}}export async function verifyIntegrity(){const _0x25f219=_0x1be164,_0x46624c={};_0x46624c[_0x25f219(0x1e7)]=_0x25f219(0x20c)+_0x25f219(0x1e9)+_0x25f219(0x223)+_0x25f219(0x1ea)+_0x25f219(0x227),_0x46624c['idYMS']=function(_0x4cb0ae,_0x2cb656){return _0x4cb0ae!==_0x2cb656;},_0x46624c[_0x25f219(0x235)]='Extension\x20'+_0x25f219(0x204)+'h',_0x46624c[_0x25f219(0x26b)]=function(_0x580403,_0x2127a4){return _0x580403===_0x2127a4;},_0x46624c[_0x25f219(0x22f)]=_0x25f219(0x245),_0x46624c[_0x25f219(0x24b)]=_0x25f219(0x254)+'integrity\x20'+'verified\x20s'+_0x25f219(0x1e8)+'y',_0x46624c[_0x25f219(0x1ef)]=function(_0x397bb0,_0x405bd7){return _0x397bb0+_0x405bd7;},_0x46624c['gAfSW']=_0x25f219(0x1fe)+_0x25f219(0x24f)+_0x25f219(0x220)+_0x25f219(0x246);const _0x571719=_0x46624c;_0x5452dc['debug'](MODULE_NAME,'Verifying\x20'+'extension\x20'+_0x25f219(0x25c));try{const _0x187234=await _0x1caeb6[_0x25f219(0x228)](INTEGRITY_KEY);if(!_0x187234){_0x5452dc['warn'](MODULE_NAME,_0x571719[_0x25f219(0x1e7)]),await storeIntegrityState();const _0x4f4522={};return _0x4f4522[_0x25f219(0x23c)]=!![],_0x4f4522[_0x25f219(0x1f5)]=[],_0x4f4522;}const _0x245c5b=await generateIntegrityHash(),_0x4b54ec=[];_0x571719[_0x25f219(0x25a)](_0x187234[_0x25f219(0x237)+'d'],_0x245c5b[_0x25f219(0x237)+'d'])&&_0x4b54ec[_0x25f219(0x20a)](_0x571719[_0x25f219(0x235)]);for(const _0x22d95a of CRITICAL_FILES){_0x187234[_0x22d95a]&&_0x245c5b[_0x22d95a]&&_0x187234[_0x22d95a]!==_0x245c5b[_0x22d95a]&&_0x4b54ec[_0x25f219(0x20a)](_0x25f219(0x238)+_0x25f219(0x253)+_0x22d95a);}_0x571719[_0x25f219(0x25a)](_0x187234[_0x25f219(0x1f2)],_0x245c5b['masterHash'])&&_0x4b54ec['push'](_0x25f219(0x254)+_0x25f219(0x210)+'\x20been\x20modi'+_0x25f219(0x256));const _0x3a3aa9=_0x4b54ec[_0x25f219(0x233)]===0x0;if(_0x3a3aa9){if(_0x571719['psIAi'](_0x571719[_0x25f219(0x22f)],_0x25f219(0x245)))_0x5452dc[_0x25f219(0x212)](MODULE_NAME,_0x571719[_0x25f219(0x24b)]);else{const _0x17400c=_0xa51846[_0x25f219(0x1f0)](_0x5f0127,arguments);return _0x9dc6bd=null,_0x17400c;}}else{const _0x322986={};_0x322986['issues']=_0x4b54ec,_0x5452dc[_0x25f219(0x21d)](MODULE_NAME,_0x25f219(0x254)+_0x25f219(0x22c)+'check\x20fail'+'ed',_0x322986);}const _0x13a824={};return _0x13a824[_0x25f219(0x23c)]=_0x3a3aa9,_0x13a824[_0x25f219(0x1f5)]=_0x4b54ec,_0x13a824;}catch(_0x1c2aa8){return _0x5452dc[_0x25f219(0x23e)](MODULE_NAME,_0x25f219(0x1f1)+_0x25f219(0x222)+'grity',_0x1c2aa8),{'isValid':![],'issues':[_0x571719['EhoPM'](_0x571719[_0x25f219(0x1f8)],_0x1c2aa8['message'])]};}}export async function resetIntegrityState(){const _0x383a92=_0x1be164,_0x131703={'NAAmY':function(_0xabd3c1,_0x3d1981){return _0xabd3c1===_0x3d1981;},'tymyG':_0x383a92(0x243),'LJPPb':function(_0x42588a){return _0x42588a();},'dcKkL':_0x383a92(0x1e6)+_0x383a92(0x242)+_0x383a92(0x266)+'ully'};try{_0x131703[_0x383a92(0x229)](_0x383a92(0x243),_0x131703[_0x383a92(0x221)])?(await _0x1caeb6[_0x383a92(0x226)+'ve'](INTEGRITY_KEY),await _0x131703[_0x383a92(0x202)](storeIntegrityState),_0x5452dc[_0x383a92(0x212)](MODULE_NAME,_0x131703[_0x383a92(0x1e5)])):_0x115254=_0x161f3e;}catch(_0x4d2d0){_0x5452dc[_0x383a92(0x23e)](MODULE_NAME,_0x383a92(0x261)+_0x383a92(0x23d)+'grity\x20stat'+'e',_0x4d2d0);}}